//- This source code is licensed under the terms of the
//- GNU Affero General Public License found in the LICENSE file in
//- the root directory of this source tree.
//-
//- Copyright (c) 2021-present Kaleidos INC

div.lightbox.lightbox-ai-analysis(tg-lb-ai-analysis)
    tg-lightbox-close
    
    section.ai-analysis-content
        header.ai-analysis-header
            h2.title
                span ðŸ¤– 
                span(translate="ISSUES.AI_ANALYSIS_TITLE")
            p.subtitle AI å·²åˆ†æž {{ctrl.results.length}} ä¸ª Issues
        
        .ai-analysis-body
            .ai-issue-card(
                ng-repeat="result in ctrl.results track by result.issueId"
            )
                .ai-card-header
                    h3.issue-title
                        span.issue-ref {{result.issueRef}}
                        span.issue-subject {{result.subject}}
                    span.ai-confidence(
                        title="AI åˆ†æžç½®ä¿¡åº¦"
                    ) ç½®ä¿¡åº¦: {{result.analysis.confidence}}
                
                .ai-card-body
                    .ai-section
                        .ai-section-title
                            tg-svg(svg-icon="icon-flag")
                            span(translate="ISSUES.AI_PRIORITY")
                        .ai-badges
                            span.ai-badge.priority(
                                ng-class="{'priority-high': result.analysis.priority === 'High', 'priority-normal': result.analysis.priority === 'Normal', 'priority-low': result.analysis.priority === 'Low'}"
                            ) {{result.analysis.priority}}
                            span.ai-reason {{result.analysis.priorityReason}}
                    
                    .ai-section
                        .ai-section-title
                            tg-svg(svg-icon="icon-bug")
                            span(translate="ISSUES.AI_TYPE")
                        .ai-badges
                            span.ai-badge.type {{result.analysis.type}}
                    
                    .ai-section
                        .ai-section-title
                            tg-svg(svg-icon="icon-exclamation")
                            span(translate="ISSUES.AI_SEVERITY")
                        .ai-badges
                            span.ai-badge.severity {{result.analysis.severity}}
                    
                    .ai-section
                        .ai-section-title
                            tg-svg(svg-icon="icon-document")
                            span(translate="ISSUES.AI_DESCRIPTION")
                        p.ai-description {{result.analysis.description}}
                    
                    .ai-section(ng-if="result.analysis.relatedModules.length > 0")
                        .ai-section-title
                            tg-svg(svg-icon="icon-module-scrum")
                            span(translate="ISSUES.AI_RELATED_MODULES")
                        .ai-badges
                            span.ai-badge.module(
                                ng-repeat="module in result.analysis.relatedModules"
                            ) {{module}}
                    
                    .ai-section(ng-if="result.analysis.solutions.length > 0")
                        .ai-section-title
                            tg-svg(svg-icon="icon-check")
                            span(translate="ISSUES.AI_SOLUTIONS")
                        ul.ai-solutions
                            li(
                                ng-repeat="solution in result.analysis.solutions"
                            ) {{solution}}
        
        .ai-analysis-footer
            button.button-green(
                type="button"
                ng-click="ctrl.close()"
                translate="COMMON.CLOSE"
            )
